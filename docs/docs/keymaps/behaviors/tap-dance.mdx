---
title: Tap-Dance Behavior
sidebar_label: Tap-Dance
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

## Summary

A tap-dance key invokes a different behavior (e.g. `kp`) corresponding to how many times it is pressed.
For example, you could configure a tap-dance key that acts as `LSHIFT` if tapped once, or Caps _Lock_ if tapped twice.
The expandability of the number of [`bindings`](#bindings) attached to a particular tap-dance is a great way to add more functionality to a single key, especially for keyboards with a limited number of keys.
Tap-dances accept two parameters from your keymap, which you can map to the behaviors within as you please.

Tap-dances are designed to resolve immediately when interrupted by another keypress. Meaning, when a keybind is pressed other than any active tap-dances, the tap-dance will activate according to the current value of its counter before the interrupting keybind is registered.

## Key Press Tap Dance

ZMK provides a simple two-tap tap dance for you to use. Press it once, and it will output a key press with the first parameter.
Press it twice within 200ms, and it will output a key press with the second parameter.

### Behavior Binding

- Reference: `&td`
- Parameters: [Keycodes](../list-of-keycodes.mdx), e.g. `N4` or `A`

Example:

```dts
&td A B
```

## Configuration

### `tapping-term-ms`

Defines the maximum elapsed time after the last tap-dance keybind press before a binding is selected from [`bindings`](#bindings). Default value is `200`ms.

### `bindings`

An array of one or more keybinds. This list can include [any ZMK keycode](../list-of-keycodes.mdx) and any listed ZMK behavior, like [hold-taps](hold-tap.mdx), or [sticky keys](sticky-key.md). The index of a keybind in the `bindings` array corresponds to the number of times the tap-dance binding is pressed. For example, in the basic tap-dance counter shown below, `&kp N2` is the second binding in the array of `bindings`: we then see an output of `2` when the `td0` binding is pressed twice.

The number of bindings in this array also determines the tap-dance's maximum number of keypresses. When a tap-dance reaches its maximum number of keypresses, it will immediately invoke the last behavior in its list of `bindings`, rather than waiting for [`tapping-term-ms`](#tapping-term-ms) to expire before the output is displayed.

### `binding-params`

The `binding-params` property determines how the parameters passed to the tap-dance behavior are passed on to the behaviors listed in `bindings`.
It is an array of `BINDING_PARAM(arg1,arg2)` elements, one for each behavior in `bindings`.
The Nth `BINDING_PARAM(arg1,arg2)` corresponds to the Nth behavior listed in `bindings`.
The number chosen for `argX` determines what the Xth parameter passed to the behavior will be:

- `1`: The Xth parameter passed will be the first parameter that the tap-dance behavior received
- `2`: The Xth parameter passed will be the second parameter that the tap-dance behavior received
- `0`: The Xth parameter will be that which is written in the `bindings` array.

Note that any parameters in `bindings` behaviors which are to be replaced should be set to `PLACEHOLDER`.

Examples:

```dts
binding-params = <BINDING_PARAM(1,2) BINDING_PARAM(0,0)>;
```

The first behavior receives both input parameters, the second receives no additional input parameters (receives those specified in the `bindings` array, if applicable).

```dts
binding-params = <BINDING_PARAM(2,0) BINDING_PARAM(1,0) BINDING_PARAM(0,0)>;
```

The first behavior receives the second input parameter as its first parameter (the second coming from the `bindings` array, if applicable), the second behavior receives the first input parameter as its first parameter (the second coming from the `bindings` array, if applicable), the third receives neither (both coming from the `bindings` array, if applicable).

```dts
binding-params = <BINDING_PARAM(0,0) BINDING_PARAM(0,0) BINDING_PARAM(0,0)>;
```

No behavior receives any input parameter that was not specified in the `bindings` array. Note that tap-dance always requires two parameters to be passed, so you will still need to write e.g. `&my_td 0 0` in your keymap - the parameters passed will be ignored[^1]. This also applies if your `binding-params` only makes use of a single parameter, in which case you'd write e.g. `&my_td A 0`.

## Example Usage

<Tabs
queryString="examples"
defaultValue="basic"
values={[
{label: 'Basic Example: Counter', value: 'basic'},
{label: 'Advanced Example: Mod-Tap Nested inside Tap-Dance', value: 'advanced'},
]}>

<TabItem value="basic">

This example configures a tap-dance named `td0` that outputs the number of times its binding is pressed from 1-3.

```dts title="Basic Tap-Dance Example: Counter"
#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>

/ {
    behaviors {
        td0: tap_dance_0 {
            compatible = "zmk,behavior-tap-dance-param";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            bindings = <&kp N1>, <&kp N2>, <&kp N3>;
            binding-params = <BINDING_PARAM(0,0) BINDING_PARAM(0,0) BINDING_PARAM(0,0)>;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        default_layer {
            bindings = <
                &td0 0 0
            >;
        };
    };
};
```

The following image describes the behavior of this particular tap-dance.

![Timing Diagram](../../assets/tap-dance/timing_diagram.svg)

:::note
Alphanumeric [`key press`](key-press.md) bindings, like those used for `td0`, will release as soon as an interrupting key press occurs. For instance, if a modifier key like `LSHIFT` were to replace the `N1` binding in the last example above, it would remain pressed until `td0`'s binding is released and the output would instead be `J`. Any following alphanumeric key presses would be capitalized as long as `td0` is held down.
:::

</TabItem>

<TabItem value="advanced">

This example configures a mod-tap inside a tap-dance named `td_mt` that outputs its first parameter on a single tap, `LSHIFT` on a single press and hold, and its second parameter when the tap-dance is pressed twice.

```dts title="Advanced Tap-Dance Example: Nested Mod-Tap"
#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>

/ {
    behaviors {
        td_mt: tap_dance_mod_tap {
            compatible = "zmk,behavior-tap-dance-param";
            #binding-cells = <2>;
            tapping-term-ms = <200>;
            bindings = <&mt LSHIFT PLACEHOLDER>, <&kp PLACEHOLDER>;
            binding-params = <BINDING_PARAM(0,1) BINDING_PARAM(2,0)>;
        };
    };

    keymap {
        compatible = "zmk,keymap";

        default_layer {
            bindings = <
                &td_mt CAPSLOCK LCTRL
            >;
        };
    };
};
```

</TabItem>
</Tabs>

[^1]: There exists a simplified version of tap-dance without any input parameters, `compatible="zmk,behavior-tap-dance"`:

```dts
/ {
    behaviors {
        td0: tap_dance_0 {
            compatible = "zmk,behavior-tap-dance";
            #binding-cells = <0>;
            tapping-term-ms = <200>;
            bindings = <&kp N1>, <&kp N2>, <&kp N3>;
        };
    };
};
```
